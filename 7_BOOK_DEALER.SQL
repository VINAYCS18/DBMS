CREATE TABLE AUTHOR
(
AUTHORID NUMBER(5),
NAME VARCHAR(15),
CITY VARCHAR2(15),
ACOUNTRY VARCHAR(15),
PRIMARY KEY(AUTHORID)
);
CREATE TABLE PUBLISHER
(
PUBLISHERID NUMBER(5),
NAMEVARCHAR(15),
CITY VARCHAR2(15),
COUNTRY VARCHAR(15),
PRIMARY KEY(PUBLISHERID)
);
CREATE TABLE CATEGORY
(
CATEGORYID NUMBER(5),
DESCRIPTION VARCHAR(15),
PRIMARY KEY(CATEGORYID)
);

CREATE TABLE CATALOG
(
BOOKID NUMBER(5),
TITLE VARCHAR2(15),
AUTHORID NUMBER(5),
PUBLISHERID NUMBER(5),
CATEGORYID NUMBER(5),
YEAR NUMBER(5),
PRICE NUMBER(10,3),
PRIMARY KEY(BOOKID),
FOREIGN KEY(AUTHORID) REFERENCES AUTHOR(AUTHORID),
FOREIGN KEY(PUBLISHERID) REFERENCES PUBLISHER(PUBLISHERID),
FOREIGN KEY(CATEGORYID) REFERENCES CATEGORY(CATEGORYID)
);
CREATE TABLE ORDER_DETAILS
(
ORDERNO NUMBER(5),
BOOKID NUMBER(5),
QUANTITY NUMBER(5),
PRIMARY KEY(ORDERNO,BOOKID),
FOREIGN KEY(BOOKID) REFERENCES CATALOG(BOOKID));

INSERT INTO AUTHOR VALUES(101, 'ABC', 'DELHI', 'INDIA');
INSERT INTO AUTHOR VALUES(102, 'TONY', 'HAYHOOD', 'USA');
INSERT INTO AUTHOR VALUES(103, 'GHI', 'PATNA', 'INDIA');
INSERT INTO AUTHOR VALUES(104, 'JKL', 'BELM', 'SRILANKA');
INSERT INTO AUTHOR VALUES(105, 'MND', 'BANGALORE', 'INDIA');

INSERT INTO PUBLISHER VALUES(1001, 'pbp', 'blore', 'INDIA');
INSERT INTO PUBLISHER VALUES(1002, 'palk', 'slaugh', 'england');
INSERT INTO PUBLISHER VALUES(1003, 'press', 'tata', 'INDIA');
INSERT INTO PUBLISHER VALUES(1004, 'rathe', 'angakara', 'srilanka');
INSERT INTO PUBLISHER VALUES(1005, 'pbp', 'blore', 'india');

INSERT INTO CATEGORY VALUES(10001, 'cs');
INSERT INTO CATEGORY VALUES(10002, 'med');
INSERT INTO CATEGORY VALUES(10003, 'bio');
INSERT INTO CATEGORY VALUES(10004, 'meteor');
INSERT INTO CATEGORY VALUES(10005, 'mech');

INSERT INTO CATALOG VALUES(1000001, 'dbms', '101', '1001', '10001', '1998', '235');
INSERT INTO CATALOG VALUES(1000002, 'or', '101', '1002', '10003', '1997', '255');
INSERT INTO CATALOG VALUES(1000003, 'cn', 102, 1003, 10002, 2001, 352);
INSERT INTO CATALOG VALUES(1000004, 'se', 102, 1003, 10001, 2002, 523);
INSERT INTO CATALOG VALUES(1000005, 'ada', '103', '1004', '10004', '2003', '124');

INSERT INTO ORDER_DETAILS VALUES(1 1000001 12);
INSERT INTO ORDER_DETAILS VALUES(1 1000002 2);
INSERT INTO ORDER_DETAILS VALUES(2 1000002 15);
INSERT INTO ORDER_DETAILS VALUES(3 1000003 23);
INSERT INTO ORDER_DETAILS VALUES(4 1000003 14);
INSERT INTO ORDER_DETAILS VALUES(5 1000005 7);

SELECT * FROM AUTHOR A WHERE A.AUTHORID IN
(SELECT C.AUTHORID FROM CATALOG C
WHERE YEAR>2000 AND
C.PRICE > (SELECT AVG (PRICE) FROM CATALOG)
GROUP BY C.AUTHORID HAVING COUNT (AUTHOR-ID)>=2);

SELECT NAME FROM AUTHOR WHERE AUTHORID IN
(SELECT AUTHORID FROM CATALOG , ORDER_DETAILS O WHERE O.BOOKID=
CATALOG.BOOK-ID AND QUANTITY=9SELECT MAX(QUANTITY) FROM OREDERDETAILS
));

UPDATE CATALOG SET PRICE=PRICE+PRICE*0.10
WHERE PUBLISHERID IN (SELECT P.PUBLISHERID
FROM PUBLISHER P
WHERE P.NAME='’PBP’);

SELECT * FROM CATALOG;
